*** Settings ***
Resource          variables.txt
Test Template     Return 400,With rdap+json header
Resource          keywords.txt
Library           Collections
Library           RequestsLibrary
Test Setup      	Create Session	rdap     ${HOST}
*** Testcases ***     uri
Return 400
	/.well-known/rdap/malformedQueries/z.cn
	/.well-known/rdap/domain/xn--s√§len.com
	/.well-known/rdap/domain/*&^.cn
	/.well-known/rdap/domain/longlabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabellonglabel.cn
	/.well-known/rdap/domain/longlabel.11111111111111111111.1111111111111111111111111111111111111111111111111111111111111111111111111111.11111111111111111111111111111111111111111111111111111111111111111111111111111111111111.111111111111111111111111111111111111111111111111111.cn
	/.well-known/rdap/ip
	/.well-known/rdap/ip/0.0.0.0
	#/.well-known/rdap/ip/1.1.1.1/23\x00
	/.well-known/rdap/ip/1.0.0.0/33
	/.well-known/rdap/ip/invalidIpv4
	/.well-known/rdap/ip/invalid.1.1.1
	/.well-known/rdap/ip/ip/1.000.0.0
	/.well-known/rdap/ip/1111
	/.well-known/rdap/ip/2001:6a8:0:1:210:4bff:
	/.well-known/rdap/entity
	/.well-known/rdap/entity/ 
	/.well-known/rdap/autnum
	/.well-known/rdap/autnum/0
	/.well-known/rdap/autnum/4294967296
	/.well-known/rdap/autnum/03661
	/.well-known/rdap/autnum/&*
	/.well-known/rdap/nameserver
*** Keywords ***
Return 400,With rdap+json header
    [Arguments]    ${uri}
    ${headers}          Create Dictionary       Accept  application/rdap+json
    ${resp}=            Get             rdap    ${uri}          headers=${headers}
    Should Be Equal As Strings      ${resp.status_code}        400
    Should Contain    ${resp.content}     errorCode
    Should Contain    ${resp.content}     title
    Should Contain    ${resp.content}     description
    Should Contain    ${resp.content}     lang
    Should Contain    ${resp.content}     BAD REQUEST